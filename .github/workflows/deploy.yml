name: Deploy to Dev Server

# Spustí se pokaždé, když pushnete do větve 'main'
on:
  push:
    branches:
      - main  # Změňte na 'develop' nebo jinou větev, pokud chcete

jobs:
  deploy:
    # Tento job poběží na našem runnerovi
    runs-on: self-hosted

    steps:
      - name: Spustit deployment skript
        run: |
          echo "Spouštím /home/kvizarena/kvizarena-arena/deploy.sh"
          /home/kvizarena/kvizarena-arena/deploy.sh
          
          # NOTE: After WebSocket integration, the deploy.sh script and kvizarena.service
          # on the server must be updated to use gunicorn with the eventlet worker:
          #   gunicorn --bind 0.0.0.0:5000 -w 3 -k eventlet "app:create_app()" --daemon
          # This ensures WebSocket connections work correctly in production.
